(()=>{"use strict";var t={17:function(t,e,n){var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function a(t){try{u(o.next(t))}catch(t){i(t)}}function s(t){try{u(o.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((o=o.apply(t,e||[])).next())}))},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=i(n(546)),s=i(n(193)),u=i(n(702)),c=i(n(304)),l=i(n(892)),f=i(n(688)),p=i(n(65)),d=i(n(32)),h=i(n(515)),_=i(n(127)),y=i(n(83)),v=i(n(754)),m=i(n(165)),g=i(n(582)),b=i(n(125)),w=i(n(253)),O=i(n(606)),x=i(n(824)),E=i(n(737)),M=i(n(502)),C=i(n(991)),P=i(n(577)),j=i(n(896)),S=i(n(41)),T=i(n(427)),A=i(n(355)),I=i(n(269)),D=i(n(721)),R=i(n(983)),L=function(){function t(){f.default.register(new S.default),f.default.register(new p.default),f.default.register(new u.default),f.default.register(new A.default),d.default.register(h.default,j.default),d.default.register(_.default,P.default),d.default.register(y.default,C.default),d.default.register(v.default,T.default),d.default.register(m.default,M.default),d.default.register(g.default,E.default),d.default.register(b.default,x.default),d.default.register(w.default,O.default),d.default.register(I.default,D.default)}return t.prototype.start=function(t){return o(this,void 0,void 0,(function(){var e,n,o,i,s=this;return r(this,(function(r){switch(r.label){case 0:return t||(t="webgl"),e="engine-config.json",(n=new URLSearchParams(location.search)).has("baseUrl")&&(l.default.baseUrl=decodeURIComponent(n.get("baseUrl")),e=l.default.baseUrl+"/"+e),[4,fetch(e).catch(this.handleLoadError)];case 1:return[4,r.sent().json()];case 2:return o=r.sent(),"webgl"===t?(console.log("[RENDERER TYPE]: WebGL enabled"),this.renderer=new R.default):(console.log("[RENDERER TYPE]: Canvas enabled"),this.renderer=new a.default),i=this.renderer,[4,c.default.load(o.scenes[0])];case 3:return i.scene=r.sent(),this.renderer.init(),this.onStart(),window.requestAnimationFrame((function(t){return s.mainLoop(t)})),[2]}}))}))},t.prototype.handleLoadError=function(t){return console.warn(t),new Response(JSON.stringify({code:500,message:t.error}))},t.prototype.mainLoop=function(t){var e=this;s.default.calculateDeltaTime(t),this.renderer.update(),this.renderer.draw(),window.requestAnimationFrame((function(t){return e.mainLoop(t)}))},t}();e.default=L},807:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});e.default=function(){this.id=0}},492:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var r=o(n(269)),i=function(){function t(){this.components=[],this.entities=[],this.entityDataMap=new Map}return t.prototype.addComponentInstance=function(t,e){if(this.entityDataMap.has(t.id)&&e.constructor.name!==r.default.name)throw"["+e.constructor.name+"]: You can't not have multiple component of the same type on entity unless that component is a script.";this.components.push(e),e.id=this.components.length,this.entityDataMap.has(t.id)?(console.log("ADDING SCRIPT COMPONENT"),this.entityDataMap.get(t.id).push(e.id)):(this.entities.push(t),this.entityDataMap.set(t.id,[e.id]))},t.prototype.dispose=function(t){if("ScriptComponentManager"===this.constructor.name&&console.log(this),this.entityDataMap.has(t.id)){for(var e=this.entityDataMap.get(t.id),n=function(t){var n=o.components.findIndex((function(n){return n.id===e[t]}));-1!==n&&o.components.splice(n,1)},o=this,r=0;r<e.length-1;r++)n(r);this.entityDataMap.delete(t.id);var i=this.entities.findIndex((function(e){return e.id===t.id}));-1!==i&&this.entities.splice(i,1),console.log(this)}},t}();e.default=i},981:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var r=o(n(739)),i=o(n(418)),a=o(n(515)),s=o(n(127)),u=o(n(165)),c=o(n(83)),l=o(n(582)),f=o(n(447)),p=o(n(625)),d=o(n(125)),h=o(n(32)),_=o(n(601)),y=o(n(688)),v=function(){function t(){this.entities=[]}return t.getInstance=function(){return t.instance||(console.log("entity manager created"),t.instance=new t),t.instance},t.prototype.create=function(){var t=new r.default;this.entities.push(t);for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n="",o=0;o<8;o++){var i=Math.floor(Math.random()*e.length);n+=e.substring(i,i+1)}return t.id=n,console.log(t.id),this.addRequiredComponents(t),t},t.prototype.destroy=function(t){var e=this.entities.findIndex((function(e){return e.id===t.id}));h.default.managers.forEach((function(e){e.dispose(t)})),y.default.systems.forEach((function(e){return e.disposeEntityRefs(t)})),-1!==e&&this.entities.splice(e,1),console.log(this.entities)},t.prototype.parseEntities=function(e){var n=[];e.entities.forEach((function(t){var e=new r.default;for(var o in e.id=t.id,e.enabled=t.enabled,t){var h=t[o];if(h)if("spriteRendererComponent"===o)e.addComponent(new u.default(h.layer,h.tileset,h.row,h.column));else if("transformComponent"===o)e.addComponent(new s.default(new i.default(h.x,h.y,h.width,h.height)));else if("cameraComponent"===o){var _=new f.default;_.viewport=new i.default(h.camera.viewport.x,h.camera.viewport.y,h.camera.viewport.width,h.camera.viewport.height),_.max=new p.default(h.camera.max.x,h.camera.max.y),e.addComponent(new c.default(_))}else"tagComponent"===o?e.addComponent(new a.default(h.name)):"tilemapComponent"===o?e.addComponent(new l.default(h.tiles,h.tilesetIndex)):"colliderComponent"===o&&e.addComponent(new d.default(h.transform,h.isTrigger))}n.push(e)})),t.getInstance().entities=n},t.prototype.packEntities=function(){var e=[];return t.getInstance().entities.forEach((function(t){var n={};_.default.componentTypes.forEach((function(e){var o=t.getComponent(e);o&&(n[e.name.charAt(0).toLowerCase()+e.name.slice(1)]=o)})),0!==Object.keys(n).length&&n.constructor===Object&&e.push(n)})),e},t.prototype.addRequiredComponents=function(t){t.addComponent(new a.default("entity"+t.id)),t.addComponent(new s.default(i.default.empty))},t}();e.default=v},32:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.register=function(e,n){if(!t.managers.has(e.name)){var o=new n;t.managers.set(e.name,o)}},t.get=function(e){if(t.managers.has(e))return t.managers.get(e);throw"Manager has not been registered: "+e},t.log=function(){t.managers.forEach((function(t){return console.log(t)}))},t.managers=new Map,t}();e.default=n},344:function(t,e,n){var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function a(t){try{u(o.next(t))}catch(t){i(t)}}function s(t){try{u(o.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((o=o.apply(t,e||[])).next())}))},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=i(n(892)),s=i(n(527)),u=function(){function t(){}return t.loadTilesets=function(t,e){var n=this;console.log("[ENGINE]: Started loading scene tilesets");var i=[],u=0;t.tilesets.forEach((function(c,l){return o(n,void 0,void 0,(function(){var n,f,p=this;return r(this,(function(d){return console.log("[ENGINE]: Started fetching "+c+" tileset"),n=new Image,f="tilesets/"+c,a.default.baseUrl&&(f="file://"+a.default.baseUrl.replace(/\\/g,"/")+"/"+f),console.log("[ENGINE] Tileset path: "+f),n.onload=function(){return o(p,void 0,void 0,(function(){return r(this,(function(o){return u++,i.splice(l,0,new s.default(n)),console.log("[ENGINE]: Tileset loaded: "+f),u===t.tilesets.length&&(console.log("[ENGINE] Scene tilesets loaded successfully."),e(i)),[2]}))}))},n.onerror=function(t){return o(p,void 0,void 0,(function(){return r(this,(function(e){return console.error(t),[2]}))}))},n.src=f,[2]}))}))}))},t}();e.default=u},83:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(e){var n=t.call(this)||this;return n.camera=e,n}return r(e,t),e}(i(n(807)).default);e.default=a},991:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(i(n(492)).default);e.default=a},125:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=i(n(625)),s=function(t){function e(e,n){var o=t.call(this)||this;return o.transform=e,o.isTrigger=n,o.points=new Array,o.transform=e,o.isTrigger=n,o.points.push(new a.default(e.x,e.y)),o.points.push(new a.default(e.x+e.width,e.y)),o.points.push(new a.default(e.x,e.y+e.height)),o.points.push(new a.default(e.x+e.width,e.y+e.height)),o}return r(e,t),e}(i(n(807)).default);e.default=s},824:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(i(n(492)).default);e.default=a},739:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var r=o(n(32)),i=o(n(269)),a=function(){function t(){this.id="",this.enabled=!0}return t.prototype.addComponent=function(t){r.default.get(t.constructor.name).addComponentInstance(this,t)},t.prototype.getComponent=function(t){var e=this;if(t.name===i.default.name)throw"Getting script components is not currently supported.";var n=r.default.get(t.name);return n.entityDataMap.has(this.id)?n.components.find((function(t){return t.id===n.entityDataMap.get(e.id)[0]})):null},t.prototype.getScriptInstances=function(){var t=this,e=r.default.get(i.default.name);return e.entityDataMap.has(this.id)?(console.log(e.components.filter((function(n){return e.entityDataMap.get(t.id).includes(n.id)}))),e.components.filter((function(n){return e.entityDataMap.get(t.id).includes(n.id)}))):[]},t}();e.default=a},253:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(e){var n=t.call(this)||this;return n.source=e,n}return r(e,t),e}(i(n(807)).default);e.default=a},606:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(i(n(492)).default);e.default=a},754:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(e,n){var o=t.call(this)||this;return o.alpha=1,o.fillStyle=e,o.alpha=n,o}return r(e,t),e}(i(n(807)).default);e.default=a},427:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(i(n(492)).default);e.default=a},269:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(e){var n=t.call(this)||this;return n.scritableEntity=e,n}return r(e,t),e}(i(n(807)).default);e.default=a},721:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(i(n(492)).default);e.default=a},165:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(e,n,o,r){var i=t.call(this)||this;return i.layer=e,i.tileset=n,i.row=o,i.column=r,i}return r(e,t),e}(i(n(807)).default);e.default=a},502:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(i(n(492)).default);e.default=a},515:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(e){var n=t.call(this)||this;return n.name=e,n}return r(e,t),e}(i(n(807)).default);e.default=a},896:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(i(n(492)).default);e.default=a},582:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(e,n){var o=t.call(this)||this;return o.tiles=e,o.tilesetIndex=n,o}return r(e,t),e.prototype.pack=function(){return{}},e}(i(n(807)).default);e.default=a},737:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(i(n(492)).default);e.default=a},127:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(e){var n=t.call(this)||this;return n.transform=e,n}return r(e,t),e}(i(n(807)).default);e.default=a},577:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(i(n(492)).default);e.default=a},892:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.engineConfig=null,t.gridSquareSize=32,t.canvasFill="#181818",t.selectionTransformFill="rgba(252,248,227, 0.7)",t.tilesets=[],t}();e.default=n},601:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var r=o(n(83)),i=o(n(125)),a=o(n(253)),s=o(n(754)),u=o(n(165)),c=o(n(515)),l=o(n(582)),f=o(n(127)),p=function(){function t(){}return t.componentNames=[c.default.name,f.default.name,u.default.name,l.default.name,s.default.name,i.default.name,r.default.name,a.default.name],t.componentTypes=[c.default,f.default,u.default,l.default,s.default,i.default,r.default,a.default],t}();e.default=p},359:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.identity=function(){return[1,0,0,0,1,0,0,0,1]},t.translation=function(t,e,n){return[1,0,0,0,0,1,0,0,0,0,1,0,t,e,n,1]},t.xRotation=function(t){var e=Math.cos(t),n=Math.sin(t);return[1,0,0,0,0,e,n,0,0,-n,e,0,0,0,0,1]},t.yRotation=function(t){var e=Math.cos(t),n=Math.sin(t);return[e,0,-n,0,0,1,0,0,n,0,e,0,0,0,0,1]},t.zRotation=function(t){var e=Math.cos(t),n=Math.sin(t);return[e,n,0,0,-n,e,0,0,0,0,1,0,0,0,0,1]},t.scaling=function(t,e,n){return[t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1]},t.multiply=function(t,e){var n=e[0],o=e[1],r=e[2],i=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],f=e[9],p=e[10],d=e[11],h=e[12],_=e[13],y=e[14],v=e[15],m=t[0],g=t[1],b=t[2],w=t[3],O=t[4],x=t[5],E=t[6],M=t[7],C=t[8],P=t[9],j=t[10],S=t[11],T=t[12],A=t[13],I=t[14],D=t[15];return[n*m+o*O+r*C+i*T,n*g+o*x+r*P+i*A,n*b+o*E+r*j+i*I,n*w+o*M+r*S+i*D,a*m+s*O+u*C+c*T,a*g+s*x+u*P+c*A,a*b+s*E+u*j+c*I,a*w+s*M+u*S+c*D,l*m+f*O+p*C+d*T,l*g+f*x+p*P+d*A,l*b+f*E+p*j+d*I,l*w+f*M+p*S+d*D,h*m+_*O+y*C+v*T,h*g+_*x+y*P+v*A,h*b+_*E+y*j+v*I,h*w+_*M+y*S+v*D]},t.translate=function(e,n,o,r){return t.multiply(e,t.translation(n,o,r))},t.xRotate=function(e,n){return t.multiply(e,t.xRotation(n))},t.yRotate=function(e,n){return t.multiply(e,t.yRotation(n))},t.zRotate=function(e,n){return t.multiply(e,t.zRotation(n))},t.scale=function(e,n,o,r){return t.multiply(e,t.scaling(n,o,r))},t.projection=function(t,e,n){return[2/t,0,0,0,0,-2/e,0,0,0,0,2/n,0,-1,1,0,1]},t.orthographic=function(t,e,n,o,r,i){return[2/(e-t),0,0,0,0,2/(o-n),0,0,0,0,2/(r-i),0,(t+e)/(t-e),(n+o)/(n-o),(r+i)/(r-i),1]},t}();e.default=n},446:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});e.default=function(){this.engineCanvas=document.querySelector("#engine-canvas")}},447:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){this.orthographicSize=5}return t.prototype.isClampedX=function(){return this.viewport.x>=this.max.x/2||0===this.viewport.x},t.prototype.isClampedY=function(){return this.viewport.y>=this.max.y/2||0===this.viewport.y},t.prototype.update=function(){},t}();e.default=n},229:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var r=o(n(193)),i=function(){function t(){var t=this;window.addEventListener("keydown",(function(e){return t.onKeyDown(e)})),window.addEventListener("keyup",(function(e){return t.onKeyUp(e)}))}return t.prototype.onKeyDown=function(e){t.codes.set(e.code.toLowerCase(),!0)},t.prototype.onKeyUp=function(e){t.codes.has(e.code.toLowerCase())&&t.codes.set(e.code.toLowerCase(),!1)},t.isPressed=function(e){return!!t.codes.has(e.toLowerCase())&&t.codes.get(e.toLowerCase())},t.horizontal=function(){return t.isPressed("keya")?-1:t.isPressed("keyd")?1:0},t.vertical=function(){return(t.isPressed("keyw")?-1:t.isPressed("keys")?1:0)*r.default.deltaTime},t.codes=new Map,t}();e.default=i},546:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var r=o(n(134)),i=o(n(625)),a=o(n(418)),s=o(n(107)),u=o(n(892)),c=o(n(447)),l=o(n(229)),f=o(n(249)),p=o(n(582)),d=o(n(32)),h=o(n(688)),_=function(){function t(){this.engineCanvas=null,this.context=null,this.uiFragmentsRender=new s.default(this),this.mousePosition=new i.default(0,0),this.lastMousePosition=new i.default(0,0),this.isMouseDown=!1,this.isSelectionMode=!1,this.selectionTransform=new a.default(0,0,0,0),this.mainCamera=new c.default,this.input=new l.default}return t.prototype.init=function(){var t=this;this.engineCanvas=document.querySelector("#engine-canvas"),this.context=this.engineCanvas.getContext("2d"),this.resizeCanvas(),this.engineCanvas.addEventListener("mousedown",(function(e){return t.onCanvasMouseDown(e)})),this.engineCanvas.addEventListener("mouseup",(function(e){return t.onCanvasMouseUp(e)})),this.engineCanvas.addEventListener("mousemove",(function(e){return t.onCanvasMouseMove(e)})),this.defaultTilemapComponent=d.default.get(p.default.name).components[0],this.mainCamera.viewport=new a.default(0,0,this.getCanvasWidth(),this.getCanvasHeight()),this.mainCamera.max=new i.default(this.scene.columns*this.scene.tileSize-this.mainCamera.viewport.width,this.scene.rows*this.scene.tileSize-this.mainCamera.viewport.height)},t.prototype.update=function(){h.default.systems.forEach((function(t){t.update()}))},t.prototype.draw=function(){var t=this;this.clearCanvas(),this.fillCanvas(),h.default.systems.forEach((function(e){e.draw(t.context)})),this.uiFragmentsRender.run(),this.resizeCanvas()},t.prototype.drawLayers=function(){var t=this;this.scene.layers.forEach((function(e){if(e.enabled)for(var n=t.mainCamera,o=Math.floor(n.viewport.x/t.scene.tileSize),r=o+n.viewport.width/t.scene.tileSize+1,i=Math.floor(n.viewport.y/t.scene.tileSize),a=i+n.viewport.height/t.scene.tileSize+1,s=-n.viewport.x+o*t.scene.tileSize,u=-n.viewport.y+i*t.scene.tileSize,c=o;c<=r;c++)for(var l=i;l<=a;l++){var f=t.defaultTilemapComponent.tiles[l*t.scene.columns+c],p=(c-o)*t.scene.tileSize+s,d=(l-i)*t.scene.tileSize+u;t.context.drawImage(t.scene.tilesets[t.defaultTilemapComponent.tilesetIndex].image,f*t.scene.tileSize,0,t.scene.tileSize,t.scene.tileSize,Math.round(p),Math.round(d),t.scene.tileSize,t.scene.tileSize)}}))},t.prototype.clearCanvas=function(){this.context.clearRect(0,0,this.getCanvasWidth(),this.getCanvasHeight())},t.prototype.fillCanvas=function(){this.context.fillStyle=u.default.canvasFill,this.context.fillRect(0,0,this.getCanvasWidth(),this.getCanvasHeight())},t.prototype.resizeCanvas=function(){this.getCanvasWidth()===u.default.width&&this.getCanvasHeight()===u.default.height||(this.setCanvasWidth(u.default.width),this.setCanvasHeight(u.default.height))},t.prototype.getCanvasHeight=function(){return this.engineCanvas.height},t.prototype.getCanvasWidth=function(){return this.engineCanvas.width},t.prototype.setCanvasHeight=function(t){this.engineCanvas.height=t},t.prototype.setCanvasWidth=function(t){this.engineCanvas.width=t},t.prototype.onCanvasMouseDown=function(t){0===t.button&&(this.isMouseDown=!0)},t.prototype.onCanvasMouseUp=function(t){this.isMouseDown=!1},t.prototype.onCanvasMouseMove=function(t){this.mousePosition=new i.default(t.offsetX,t.offsetY),this.gridCoordinates=r.default(this.mousePosition),f.default(this.selectionTransform)?this.selectionTransform=new a.default(this.gridCoordinates.x*u.default.gridSquareSize,this.gridCoordinates.y*u.default.gridSquareSize,0,0):(this.selectionTransform.width=this.gridCoordinates.x*u.default.gridSquareSize-this.selectionTransform.x+u.default.gridSquareSize,this.selectionTransform.height=this.gridCoordinates.y*u.default.gridSquareSize-this.selectionTransform.y+u.default.gridSquareSize)},t}();e.default=_},527:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});e.default=function(t){this.image=t}},983:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function a(t){try{u(o.next(t))}catch(t){i(t)}}function s(t){try{u(o.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((o=o.apply(t,e||[])).next())}))},a=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var u=s(n(446)),c=s(n(359)),l=function(){},f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.context=null,e.shaderPath="/shaders",e._drawables=[],e._vertexShaders=[],e._fragmentShaders=[],e._testTranslationAmount=[0,0,0],e._testRotationAmount=[0,1,0],e._testScaleAmount=[1,1,0],e._testTranslateSpeed=100,e.angleInDegress=0,e.angleInRadians=0,e}return r(e,t),e.prototype.init=function(){return i(this,void 0,void 0,(function(){var t,e,n,o;return a(this,(function(r){switch(r.label){case 0:if(this.context=this.engineCanvas.getContext("webgl"),!this.context)throw"WebGL not supported.";return this.engineCanvas.width=window.innerWidth,this.engineCanvas.height=window.innerHeight,[4,fetch(this.shaderPath+"/vertex-shader.glsl")];case 1:return[4,r.sent().text()];case 2:return t=r.sent(),[4,fetch(this.shaderPath+"/fragment-shader.glsl")];case 3:return[4,r.sent().text()];case 4:return e=r.sent(),n=this._createShader(this.context.VERTEX_SHADER,t),o=this._createShader(this.context.FRAGMENT_SHADER,e),this._program=this._createProgram(n,o),this._positionAttributeLocation=this.context.getAttribLocation(this._program,"a_position"),this._colorAttributeLocation=this.context.getAttribLocation(this._program,"a_color"),this._colorBuffer=this.context.createBuffer(),this.context.bindBuffer(this.context.ARRAY_BUFFER,this._colorBuffer),this.context.bufferData(this.context.ARRAY_BUFFER,new Uint8Array([255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),this.context.STATIC_DRAW),this._colorUniformLocation=this.context.getUniformLocation(this._program,"u_color"),this._resolutionUniformLocation=this.context.getUniformLocation(this._program,"u_resolution"),this._matrixUniformLocation=this.context.getUniformLocation(this._program,"u_matrix"),this._createDrawable([10,20,0,80,20,0,10,30,0,10,30,0,80,20,0,80,30,0]),[2]}}))}))},e.prototype._createDrawable=function(t){var e=new l;e.positions=t,e.buffer=this.context.createBuffer(),this.context.bindBuffer(this.context.ARRAY_BUFFER,e.buffer),this.context.bufferData(this.context.ARRAY_BUFFER,new Float32Array(e.positions),this.context.STATIC_DRAW),this._drawables.push(e)},e.prototype._convertAngleUnitCircleCoordinates=function(t){var e=t*Math.PI/180;return{sine:Math.sin(e),cosine:Math.cos(e)}},e.prototype.update=function(){},e.prototype.draw=function(){var t=this;console.log("[WEBGL]: Draw");var e=this._convertAngleUnitCircleCoordinates(this.angleInDegress);this._testRotationAmount[0]=e.sine,this._testRotationAmount[1]=e.cosine,this.context.viewport(0,0,this.engineCanvas.width,this.engineCanvas.height),this.context.clearColor(0,0,0,0),this.context.clear(this.context.COLOR_BUFFER_BIT),this.context.useProgram(this._program),this.context.uniform2f(this._resolutionUniformLocation,this.engineCanvas.width,this.engineCanvas.height),this._drawables.forEach((function(e){t.context.enableVertexAttribArray(t._positionAttributeLocation),t.context.bindBuffer(t.context.ARRAY_BUFFER,e.buffer);var n=t.context.FLOAT;t.context.vertexAttribPointer(t._positionAttributeLocation,3,n,!1,0,0),t.context.enableVertexAttribArray(t._colorAttributeLocation),t.context.bindBuffer(t.context.ARRAY_BUFFER,t._colorBuffer);var o=t.context.UNSIGNED_BYTE;t.context.vertexAttribPointer(t._colorAttributeLocation,3,o,!1,0,0),t.context.uniform4f(t._colorUniformLocation,1,1,1,1);var r=c.default.projection(t.context.canvas.width,t.context.canvas.height,400);r=c.default.translate(r,t._testTranslationAmount[0],t._testTranslationAmount[1],t._testTranslationAmount[2]),r=c.default.xRotate(r,t.angleInDegress*Math.PI/180),r=c.default.yRotate(r,t.angleInDegress*Math.PI/180),r=c.default.zRotate(r,t.angleInDegress*Math.PI/180),r=c.default.scale(r,t._testScaleAmount[0],t._testScaleAmount[1],t._testScaleAmount[2]),t.context.uniformMatrix4fv(t._matrixUniformLocation,!1,r);var i=t.context.TRIANGLES;t.context.drawArrays(i,0,6)}))},e.prototype._createShader=function(t,e){var n=this.context.createShader(t);if(this.context.shaderSource(n,e),this.context.compileShader(n),this.context.getShaderParameter(n,this.context.COMPILE_STATUS))return n;throw console.log(this.context.getShaderInfoLog(n)),this.context.deleteShader(n),"[SHADER ERROR]: Unable to load shader "+t},e.prototype._createProgram=function(t,e){var n=this.context.createProgram();if(this.context.attachShader(n,t),this.context.attachShader(n,e),this.context.linkProgram(n),this.context.getProgramParameter(n,this.context.LINK_STATUS))return n;throw console.log(this.context.getProgramInfoLog(n)),this.context.deleteProgram(n),"[SHADER ERROR]: Unable to link shaders to program"},e}(u.default);e.default=f},134:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var r=o(n(892)),i=o(n(625));e.default=function(t){var e=new i.default(0,0);return e.x=Math.floor(t.x/r.default.gridSquareSize),e.y=Math.floor(t.y/r.default.gridSquareSize),e}},249:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return 0===t.x&&0===t.y&&0===t.width&&0===t.height}},915:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});e.default=function(){this.tilesets=new Array,this.layers=new Array}},625:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});e.default=function(t,e){this.x=t,this.y=e}},418:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e,n,o){this.x=t,this.y=e,this.width=n,this.height=o}return t.prototype.getScreenX=function(t){return this.x-t.viewport.x},t.prototype.clampX=function(t,e){return this.x<t?(this.x=t,!0):this.x>e?(this.x=e,!0):void 0},t.prototype.clampY=function(t,e){return this.y<=t?(this.y=t,!0):this.y>=e?(this.y=e,!0):void 0},t.prototype.offsetX=function(){return this.x+this.width},t.prototype.offsetY=function(){return this.y+this.height},t.prototype.lerp=function(t,e,n){return t+(e-t)*((n=n<0?0:n)>1?1:n)},Object.defineProperty(t,"empty",{get:function(){return new t(0,0,0,0)},enumerable:!1,configurable:!0}),t}();e.default=n},304:function(t,e,n){var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function a(t){try{u(o.next(t))}catch(t){i(t)}}function s(t){try{u(o.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((o=o.apply(t,e||[])).next())}))},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=i(n(981)),s=i(n(344)),u=i(n(892)),c=i(n(915)),l=function(){function t(){}return t.load=function(t){return o(this,void 0,void 0,(function(){var e,n,o,i;return r(this,(function(r){switch(r.label){case 0:return console.log("[ENGINE]: Started loading scene."),e=new c.default,n="scenes\\"+t+".json",u.default.baseUrl&&(n=u.default.baseUrl+"\\"+n),[4,fetch(n)];case 1:return o=r.sent(),console.log("[ENGINE]: Scene feteched successfully;"),[4,o.json()];case 2:return i=r.sent(),console.log("[ENGINE]: Scene parsed successfully;"),a.default.getInstance().parseEntities(i),console.log("[ENGINE]: Scene entities parsed successfully."),e.name=i.name,e.rows=i.columns,e.columns=i.columns,e.tileSize=i.tileSize,e.layers=i.layers,u.default.scene=e,[2,new Promise((function(t,n){s.default.loadTilesets(i,(function(n){e.tilesets=n,u.default.tilesets=n,t(e)}))}))]}}))}))},t}();e.default=l},871:(t,e)=>{var n;Object.defineProperty(e,"__esModule",{value:!0}),e.CollisionDirection=void 0,(n=e.CollisionDirection||(e.CollisionDirection={}))[n.NONE=0]="NONE",n[n.TOP=1]="TOP",n[n.RIGHT=2]="RIGHT",n[n.BOTTOM=3]="BOTTOM",n[n.LEFT=4]="LEFT"},702:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=i(n(125)),s=i(n(32)),u=i(n(269)),c=i(n(127)),l=i(n(525)),f=n(871),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="collision-name",e.currentEntityCollisions=new Map,e}return r(e,t),e.prototype.disposeEntityRefs=function(t){this.currentEntityCollisions.has(t.id)&&this.currentEntityCollisions.delete(t.id),this.currentEntityCollisions.forEach((function(e,n){var o=e.indexOf(t.id);-1!==o&&e.splice(o,1)}))},e.prototype.update=function(){for(var t=s.default.get(a.default.name),e=0;e<t.entities.length;e++)for(var n=e+1;n<t.entities.length;n++)this.resolveCollision(t.entities[e],t.entities[n])},e.prototype.resolveCollision=function(t,e){if(t&&e){var n=t.getComponent(a.default),o=e.getComponent(a.default),r=t.getComponent(c.default),i=e.getComponent(c.default);if(r&&i){var l=r.transform,p=i.transform,d=l.x+l.width/2-(p.x+p.width/2),h=l.y+l.height/2-(p.y+p.height/2),_=l.width/2+p.width/2,y=l.height/2+p.height/2,v=f.CollisionDirection.NONE;if(Math.abs(d)<_&&Math.abs(h)<y)if(this.currentEntityCollisions.has(t.id)&&-1!==this.currentEntityCollisions.get(t.id).indexOf(e.id))console.log("TRIGGER STAY"),t.getScriptInstances().forEach((function(t){t.scriptableEntityInstance&&t.scriptableEntityInstance.onTriggerEnter&&t.scriptableEntityInstance.onTriggerStay(e)})),e.getScriptInstances().forEach((function(e){e.scriptableEntityInstance&&e.scriptableEntityInstance.onTriggerEnter&&e.scriptableEntityInstance.onTriggerStay(t)}));else if(this.currentEntityCollisions.has(t.id)?this.currentEntityCollisions.get(t.id).push(e.id):this.currentEntityCollisions.set(t.id,[e.id]),n.isTrigger||o.isTrigger)console.log("TRIGGER ENTER"),console.log(t),console.log(e),t.getScriptInstances().forEach((function(t){t.scriptableEntityInstance&&t.scriptableEntityInstance.onTriggerEnter&&t.scriptableEntityInstance.onTriggerEnter(e)})),e.getScriptInstances().forEach((function(e){e.scriptableEntityInstance&&e.scriptableEntityInstance.onTriggerEnter&&e.scriptableEntityInstance.onTriggerEnter(t)}));else{var m=_-Math.abs(d),g=y-Math.abs(h);m>=g?h>0?(v=f.CollisionDirection.TOP,l.y+=g):(v=f.CollisionDirection.BOTTOM,l.y-=g):d>0?(v=f.CollisionDirection.LEFT,l.x+=m):(v=f.CollisionDirection.RIGHT,l.x-=m)}else this.currentEntityCollisions.has(t.id)&&-1!==this.currentEntityCollisions.get(t.id).indexOf(e.id)&&(this.currentEntityCollisions.delete(t.id),s.default.get(u.default.name).components,t.getScriptInstances().forEach((function(t){t.scriptableEntityInstance&&t.scriptableEntityInstance.onTriggerEnter&&t.scriptableEntityInstance.onTriggerLeave(e)})),e.getScriptInstances().forEach((function(e){e.scriptableEntityInstance&&e.scriptableEntityInstance.onTriggerEnter&&e.scriptableEntityInstance.onTriggerLeave(t)})));return v}console.log("[ENTITY NO LONGER EXISTS ABORTING COLLISION CHECK]")}},e.prototype.draw=function(){},e}(l.default);e.default=p},65:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=i(n(32)),s=i(n(754)),u=i(n(165)),c=i(n(127)),l=i(n(892)),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="render-system",e}return r(e,t),e.prototype.update=function(){},e.prototype.disposeEntityRefs=function(t){},e.prototype.draw=function(t){a.default.get(u.default.name).entities.forEach((function(e){var n=e.getComponent(u.default),o=e.getComponent(c.default);if(n){var r=e.getComponent(s.default);void 0===n.tileset?(t.fillStyle=r.fillStyle,t.globalAlpha=r.alpha,t.fillRect(o.transform.x,o.transform.y,o.transform.width,o.transform.height)):(console.log("test"),t.drawImage(l.default.tilesets[1].image,n.column*l.default.scene.tileSize,n.row*l.default.scene.tileSize,l.default.scene.tileSize,l.default.scene.tileSize,o.transform.x-0,o.transform.y-0,l.default.scene.tileSize,l.default.scene.tileSize))}t.fillStyle=l.default.canvasFill,t.globalAlpha=1}))},e}(i(n(525)).default);e.default=f},355:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=i(n(32)),s=i(n(269)),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="script-system",e}return r(e,t),e.prototype.disposeEntityRefs=function(t){},e.prototype.update=function(){var t=a.default.get(s.default.name);t.entities.forEach((function(e){t.entityDataMap.get(e.id).forEach((function(n){var o=t.components.find((function(t){return t.id===n}));o.scriptableEntityInstance||(o.scriptableEntityInstance=new o.scritableEntity,o.scriptableEntityInstance.entity=e,o.scriptableEntityInstance.onCreate()),o.scriptableEntityInstance.update()}))}))},e.prototype.draw=function(){},e}(i(n(525)).default);e.default=u},688:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.register=function(e){-1===t.systems.findIndex((function(t){return t.name===e.name}))&&t.systems.push(e)},t.get=function(e){return t.systems.find((function(t){return t.name===e}))},t.systems=[],t}();e.default=n},525:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});e.default=function(){}},41:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=i(n(32)),s=i(n(582)),u=i(n(892)),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="tilemap-system",e}return r(e,t),e.prototype.update=function(){},e.prototype.disposeEntityRefs=function(t){},e.prototype.draw=function(t){a.default.get(s.default.name).components.forEach((function(e){for(var n=0;n<=64;n++)for(var o=0;o<=64;o++){var r=e.tiles[64*o+n],i=32*(n-0)+0,a=32*(o-0)+0;t.drawImage(u.default.tilesets[e.tilesetIndex].image,32*r,0,32,32,Math.round(i),Math.round(a),32,32)}}))},e}(i(n(525)).default);e.default=c},193:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.calculateDeltaTime=function(e){if(!t.lastTimestamp)return t.lastTimestamp=e,void(t.fps=0);t.deltaTime=(e-t.lastTimestamp)/1e3,t.lastTimestamp=e,t.fps=1/t.deltaTime},t.lastTimestamp=performance.now(),t}();e.default=n},107:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t){this.graphics=t}return t.prototype.run=function(){this.draw()},t.prototype.draw=function(){},t}();e.default=n}},e={};!function n(o){if(e[o])return e[o].exports;var r=e[o]={exports:{}};return t[o].call(r.exports,r,r.exports,n),r.exports}(17)})();