(()=>{"use strict";var t={17:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function a(t){try{u(o.next(t))}catch(t){i(t)}}function s(t){try{u(o.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((o=o.apply(t,e||[])).next())}))},a=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var u=s(n(193)),c=s(n(702)),l=s(n(304)),f=s(n(892)),p=s(n(122)),h=s(n(314)),d=s(n(913)),_=s(n(6)),y=s(n(933)),v=s(n(191)),g=s(n(680)),m=s(n(975)),b=s(n(249)),w=s(n(545)),O=s(n(492)),x=s(n(591)),j=s(n(901)),C=s(n(221)),P=s(n(292)),M=s(n(353)),E=s(n(355)),A=s(n(869)),S=s(n(570)),T=s(n(107)),R=s(n(516)),I=function(){function t(){p.default.register(new c.default),p.default.register(new E.default),h.default.register(d.default,P.default),h.default.register(_.default,C.default),h.default.register(y.default,j.default),h.default.register(v.default,M.default),h.default.register(g.default,x.default),h.default.register(m.default,O.default),h.default.register(b.default,w.default),h.default.register(A.default,S.default)}return t.prototype.init=function(t){return i(this,void 0,void 0,(function(){var e,n,o,r,i=this;return a(this,(function(a){switch(a.label){case 0:return t||(t="canvas"),e="manifest.json",(n=new URLSearchParams(location.search)).has("baseUrl")&&(f.default.baseUrl=decodeURIComponent(n.get("baseUrl")),e=f.default.baseUrl+"/"+e),[4,fetch(e).catch(this.handleLoadError)];case 1:return[4,a.sent().json()];case 2:return o=a.sent(),[4,l.default.load(o.scenes[0])];case 3:return r=a.sent(),this.renderer="webgl"===t?new T.default(r.scene,r.tilesets):new R.default(r.scene,r.tilesets),this.renderer.init(),this.onStart(),window.requestAnimationFrame((function(t){return i.mainLoop(t)})),[2]}}))}))},t.prototype.handleLoadError=function(t){return console.warn(t),new Response(JSON.stringify({code:500,message:t.error}))},t.prototype.mainLoop=function(t){var e=this;u.default.calculateDeltaTime(t),p.default.systems.forEach((function(t){t.update()})),this.renderer.draw(),window.requestAnimationFrame((function(t){return e.mainLoop(t)}))},t}();e.default=I;var D=function(t){function e(){return t.call(this)||this}return r(e,t),e.prototype.onStart=function(){},e}(I);document.addEventListener("DOMContentLoaded",(function(t){(new D).init("canvas")}))},778:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var r=o(n(869)),i=function(){function t(){this.instances=[],this.entities=[],this.map={}}return t.prototype.addComponentInstance=function(t,e){if(this.map[t.id]){if(typeof e!=typeof r.default)throw"["+e.constructor.name+"]: You can't not have multiple component of the same type on entity unless that component is a script."}else this.entities.push(t);this.instances.push(e),this.map[t.id]=this.instances.length-1},t.prototype.getInstance=function(t){var e=this.map[t.id];return e||0===e?this.instances[e]:null},t.prototype.dispose=function(t){if("ScriptComponentManager"===this.constructor.name&&console.log(this),this.map[t.id]){this.instances.splice(this.map[t.id]),delete this.map[t.id];var e=this.entities.findIndex((function(e){return e.id===t.id}));-1!==e&&this.entities.splice(e,1),console.log(this)}},t}();e.default=i},933:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(e){var n=t.call(this)||this;return n.camera=e,n}return r(e,t),e}(i(n(334)).default);e.default=a},975:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=i(n(625)),s=function(t){function e(e,n){var o=t.call(this)||this;return o.transform=e,o.isTrigger=n,o.points=new Array,o.transform=e,o.isTrigger=n,o.points.push(new a.default(e.x,e.y)),o.points.push(new a.default(e.x+e.width,e.y)),o.points.push(new a.default(e.x,e.y+e.height)),o.points.push(new a.default(e.x+e.width,e.y+e.height)),o}return r(e,t),e}(i(n(334)).default);e.default=s},249:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(e){var n=t.call(this)||this;return n.source=e,n}return r(e,t),e}(i(n(334)).default);e.default=a},191:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(e,n){var o=t.call(this)||this;return o.alpha=1,o.fillStyle=e,o.alpha=n,o}return r(e,t),e}(i(n(334)).default);e.default=a},869:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(e){var n=t.call(this)||this;return n.scritableEntity=e,n}return r(e,t),e}(i(n(334)).default);e.default=a},680:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(e,n,o,r){var i=t.call(this)||this;return i.layer=e,i.tilesetIndex=n,i.row=o,i.column=r,i}return r(e,t),e}(i(n(334)).default);e.default=a},913:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(e){var n=t.call(this)||this;return n.name=e,n}return r(e,t),e}(i(n(334)).default);e.default=a},6:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(e){var n=t.call(this)||this;return n.transform=e,n}return r(e,t),e}(i(n(334)).default);e.default=a},334:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});e.default=function(){}},901:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(i(n(778)).default);e.default=a},492:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(i(n(778)).default);e.default=a},545:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(i(n(778)).default);e.default=a},353:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(i(n(778)).default);e.default=a},570:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(i(n(778)).default);e.default=a},591:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(i(n(778)).default);e.default=a},292:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(i(n(778)).default);e.default=a},221:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(i(n(778)).default);e.default=a},892:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.engineConfig=null,t.gridSquareSize=32,t.canvasFill="#181818",t.selectionTransformFill="rgba(252,248,227, 0.7)",t}();e.default=n},601:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var r=o(n(933)),i=o(n(975)),a=o(n(249)),s=o(n(191)),u=o(n(869)),c=o(n(680)),l=o(n(913)),f=o(n(6)),p=function(){function t(){}return t.componentTypes=[l.default,f.default,c.default,s.default,i.default,r.default,a.default,u.default],t.characters="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t}();e.default=p},937:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var r=o(n(933)),i=o(n(975)),a=o(n(314)),s=o(n(680)),u=o(n(913)),c=o(n(6)),l=o(n(601)),f=o(n(447)),p=o(n(954)),h=o(n(625)),d=o(n(418)),_=o(n(122)),y=function(){function t(){this.entities=[]}return t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.create=function(){var t=new p.default;this.entities.push(t);for(var e="",n=0;n<8;n++){var o=Math.floor(Math.random()*l.default.characters.length);e+=l.default.characters.substring(o,o+1)}return t.id="entity-"+e,t.addComponent(new u.default("entity"+t.id)),t.addComponent(new c.default(d.default.empty)),t},t.prototype.dispose=function(t){var e=this.entities.findIndex((function(e){return e.id===t.id}));-1!==e&&(a.default.managers.forEach((function(e){return e.dispose(t)})),_.default.systems.forEach((function(e){return e.dispose(t)})),this.entities.splice(e,1))},t.prototype.parseEntities=function(e){var n=[];e.entities.forEach((function(t){var e=new p.default;for(var o in e.id=t.id,e.enabled=t.enabled,t){var a=t[o];if(a)if("spriteRendererComponent"===o)e.addComponent(new s.default(a.layer,a.tileset,a.row,a.column));else if("transformComponent"===o)e.addComponent(new c.default(new d.default(a.x,a.y,a.width,a.height)));else if("cameraComponent"===o){var l=new f.default;l.viewport=new d.default(a.camera.viewport.x,a.camera.viewport.y,a.camera.viewport.width,a.camera.viewport.height),l.max=new h.default(a.camera.max.x,a.camera.max.y),e.addComponent(new r.default(l))}else"tagComponent"===o?e.addComponent(new u.default(a.name)):"colliderComponent"===o&&e.addComponent(new i.default(a.transform,a.isTrigger))}n.push(e)})),t.getInstance().entities=n},t.prototype.packEntities=function(){var e=[];return t.getInstance().entities.forEach((function(t){var n={};l.default.componentTypes.forEach((function(e){var o=t.getComponent(e);o&&(n[e.name.charAt(0).toLowerCase()+e.name.slice(1)]=o)})),0!==Object.keys(n).length&&n.constructor===Object&&e.push(n)})),e},t.prototype.getComponents=function(t){var e=[];return a.default.managers.forEach((function(n){n.map[t.id]&&e.push(n.instances[n.map[t.id]])})),e},t}();e.default=y},359:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.identity=function(){return[1,0,0,0,1,0,0,0,1]},t.translation=function(t,e,n){return[1,0,0,0,0,1,0,0,0,0,1,0,t,e,n,1]},t.xRotation=function(t){var e=Math.cos(t),n=Math.sin(t);return[1,0,0,0,0,e,n,0,0,-n,e,0,0,0,0,1]},t.yRotation=function(t){var e=Math.cos(t),n=Math.sin(t);return[e,0,-n,0,0,1,0,0,n,0,e,0,0,0,0,1]},t.zRotation=function(t){var e=Math.cos(t),n=Math.sin(t);return[e,n,0,0,-n,e,0,0,0,0,1,0,0,0,0,1]},t.scaling=function(t,e,n){return[t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1]},t.multiply=function(t,e){var n=e[0],o=e[1],r=e[2],i=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],f=e[9],p=e[10],h=e[11],d=e[12],_=e[13],y=e[14],v=e[15],g=t[0],m=t[1],b=t[2],w=t[3],O=t[4],x=t[5],j=t[6],C=t[7],P=t[8],M=t[9],E=t[10],A=t[11],S=t[12],T=t[13],R=t[14],I=t[15];return[n*g+o*O+r*P+i*S,n*m+o*x+r*M+i*T,n*b+o*j+r*E+i*R,n*w+o*C+r*A+i*I,a*g+s*O+u*P+c*S,a*m+s*x+u*M+c*T,a*b+s*j+u*E+c*R,a*w+s*C+u*A+c*I,l*g+f*O+p*P+h*S,l*m+f*x+p*M+h*T,l*b+f*j+p*E+h*R,l*w+f*C+p*A+h*I,d*g+_*O+y*P+v*S,d*m+_*x+y*M+v*T,d*b+_*j+y*E+v*R,d*w+_*C+y*A+v*I]},t.translate=function(e,n,o,r){return t.multiply(e,t.translation(n,o,r))},t.xRotate=function(e,n){return t.multiply(e,t.xRotation(n))},t.yRotate=function(e,n){return t.multiply(e,t.yRotation(n))},t.zRotate=function(e,n){return t.multiply(e,t.zRotation(n))},t.scale=function(e,n,o,r){return t.multiply(e,t.scaling(n,o,r))},t.projection=function(t,e,n){return[2/t,0,0,0,0,-2/e,0,0,0,0,2/n,0,-1,1,0,1]},t.orthographic=function(t,e,n,o,r,i){return[2/(e-t),0,0,0,0,2/(o-n),0,0,0,0,2/(r-i),0,(t+e)/(t-e),(n+o)/(n-o),(r+i)/(r-i),1]},t}();e.default=n},447:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){this.orthographicSize=5}return t.prototype.isClampedX=function(){return this.viewport.x>=this.max.x/2||0===this.viewport.x},t.prototype.isClampedY=function(){return this.viewport.y>=this.max.y/2||0===this.viewport.y},t.prototype.update=function(){},t}();e.default=n},346:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});e.default=function(t,e){if(this.tilesets=[],this.scene=t,this.tilesets=e,!this.scene)throw"You cannot initialize the renderer without a scene.";if(!this.tilesets||0===this.tilesets.length)throw"You cannot initialize the renderer without any tilesets."}},516:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=i(n(537)),s=i(n(418)),u=i(n(447)),c=i(n(680)),l=i(n(191)),f=i(n(6)),p=i(n(346)),h=i(n(314)),d=function(t){function e(e,n){var o=t.call(this,e,n)||this;return o.tilesets=[],o.mainCamera=new u.default,o}return r(e,t),e.prototype.init=function(){var t=this;this.engineCanvas=document.querySelector("#engine-canvas"),this.context=this.engineCanvas.getContext("2d"),this.engineCanvas.addEventListener("mousedown",(function(e){return t.onCanvasMouseDown(e)})),this.engineCanvas.addEventListener("mouseup",(function(e){return t.onCanvasMouseUp(e)})),this.engineCanvas.addEventListener("mousemove",(function(e){return t.onCanvasMouseMove(e)})),this.mainCamera.viewport=new s.default(0,0,this.getCanvasWidth(),this.getCanvasHeight()),this.mainCamera.max=new a.default(this.scene.columns*this.scene.tileSize-this.mainCamera.viewport.width,this.scene.rows*this.scene.tileSize-this.mainCamera.viewport.height)},e.prototype.draw=function(){this.clearCanvas(),this.render(),this.resizeCanvas()},e.prototype.render=function(){var t=this;this.scene.layers.forEach((function(e,n){if(e.enabled){var o=h.default.get(c.default.name);o.entities.forEach((function(e){var n=o.getInstance(e),r=e.getComponent(f.default),i=e.getComponent(l.default);i&&t.applyMaterial(i),t.context.drawImage(t.tilesets[n.tilesetIndex].image,n.column*t.scene.tileSize,n.row*t.scene.tileSize,t.scene.tileSize,t.scene.tileSize,r.transform.x-0,r.transform.y-0,t.scene.tileSize,t.scene.tileSize)}))}}))},e.prototype.applyMaterial=function(t){this.context.fillStyle=t.fillStyle,this.context.globalAlpha=t.alpha},e.prototype.clearCanvas=function(){this.context.clearRect(0,0,this.getCanvasWidth(),this.getCanvasHeight())},e.prototype.resizeCanvas=function(){this.getCanvasWidth()===window.innerWidth&&this.getCanvasHeight()===window.innerHeight||(this.setCanvasWidth(window.innerWidth),this.setCanvasHeight(window.innerHeight))},e.prototype.getCanvasHeight=function(){return this.engineCanvas.height},e.prototype.getCanvasWidth=function(){return this.engineCanvas.width},e.prototype.setCanvasHeight=function(t){this.engineCanvas.height=t},e.prototype.setCanvasWidth=function(t){this.engineCanvas.width=t},e.prototype.onCanvasMouseDown=function(t){console.log("mousedown")},e.prototype.onCanvasMouseUp=function(t){console.log("mouseup")},e.prototype.onCanvasMouseMove=function(t){console.log("mousemove")},e}(p.default);e.default=d},107:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function a(t){try{u(o.next(t))}catch(t){i(t)}}function s(t){try{u(o.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((o=o.apply(t,e||[])).next())}))},a=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var u=s(n(346)),c=s(n(359)),l=function(){},f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tilesets=[],e.context=null,e.shaderPath="/shaders",e._drawables=[],e._vertexShaders=[],e._fragmentShaders=[],e._testTranslationAmount=[0,0,0],e._testRotationAmount=[0,1,0],e._testScaleAmount=[1,1,0],e._testTranslateSpeed=100,e.angleInDegress=0,e.angleInRadians=0,e}return r(e,t),e.prototype.init=function(){return i(this,void 0,void 0,(function(){var t,e,n,o;return a(this,(function(r){switch(r.label){case 0:if(this.context=this.engineCanvas.getContext("webgl"),!this.context)throw"WebGL not supported.";return this.engineCanvas.width=window.innerWidth,this.engineCanvas.height=window.innerHeight,[4,fetch(this.shaderPath+"/vertex-shader.glsl")];case 1:return[4,r.sent().text()];case 2:return t=r.sent(),[4,fetch(this.shaderPath+"/fragment-shader.glsl")];case 3:return[4,r.sent().text()];case 4:return e=r.sent(),n=this._createShader(this.context.VERTEX_SHADER,t),o=this._createShader(this.context.FRAGMENT_SHADER,e),this._program=this._createProgram(n,o),this._positionAttributeLocation=this.context.getAttribLocation(this._program,"a_position"),this._colorAttributeLocation=this.context.getAttribLocation(this._program,"a_color"),this._colorBuffer=this.context.createBuffer(),this.context.bindBuffer(this.context.ARRAY_BUFFER,this._colorBuffer),this.context.bufferData(this.context.ARRAY_BUFFER,new Uint8Array([255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),this.context.STATIC_DRAW),this._colorUniformLocation=this.context.getUniformLocation(this._program,"u_color"),this._resolutionUniformLocation=this.context.getUniformLocation(this._program,"u_resolution"),this._matrixUniformLocation=this.context.getUniformLocation(this._program,"u_matrix"),this._createDrawable([10,20,0,80,20,0,10,30,0,10,30,0,80,20,0,80,30,0]),[2]}}))}))},e.prototype._createDrawable=function(t){var e=new l;e.positions=t,e.buffer=this.context.createBuffer(),this.context.bindBuffer(this.context.ARRAY_BUFFER,e.buffer),this.context.bufferData(this.context.ARRAY_BUFFER,new Float32Array(e.positions),this.context.STATIC_DRAW),this._drawables.push(e)},e.prototype._convertAngleUnitCircleCoordinates=function(t){var e=t*Math.PI/180;return{sine:Math.sin(e),cosine:Math.cos(e)}},e.prototype.draw=function(){var t=this;console.log("[WEBGL]: Draw");var e=this._convertAngleUnitCircleCoordinates(this.angleInDegress);this._testRotationAmount[0]=e.sine,this._testRotationAmount[1]=e.cosine,this.context.viewport(0,0,this.engineCanvas.width,this.engineCanvas.height),this.context.clearColor(0,0,0,0),this.context.clear(this.context.COLOR_BUFFER_BIT),this.context.useProgram(this._program),this.context.uniform2f(this._resolutionUniformLocation,this.engineCanvas.width,this.engineCanvas.height),this._drawables.forEach((function(e){t.context.enableVertexAttribArray(t._positionAttributeLocation),t.context.bindBuffer(t.context.ARRAY_BUFFER,e.buffer);var n=t.context.FLOAT;t.context.vertexAttribPointer(t._positionAttributeLocation,3,n,!1,0,0),t.context.enableVertexAttribArray(t._colorAttributeLocation),t.context.bindBuffer(t.context.ARRAY_BUFFER,t._colorBuffer);var o=t.context.UNSIGNED_BYTE;t.context.vertexAttribPointer(t._colorAttributeLocation,3,o,!1,0,0),t.context.uniform4f(t._colorUniformLocation,1,1,1,1);var r=c.default.projection(t.context.canvas.width,t.context.canvas.height,400);r=c.default.translate(r,t._testTranslationAmount[0],t._testTranslationAmount[1],t._testTranslationAmount[2]),r=c.default.xRotate(r,t.angleInDegress*Math.PI/180),r=c.default.yRotate(r,t.angleInDegress*Math.PI/180),r=c.default.zRotate(r,t.angleInDegress*Math.PI/180),r=c.default.scale(r,t._testScaleAmount[0],t._testScaleAmount[1],t._testScaleAmount[2]),t.context.uniformMatrix4fv(t._matrixUniformLocation,!1,r);var i=t.context.TRIANGLES;t.context.drawArrays(i,0,6)}))},e.prototype._createShader=function(t,e){var n=this.context.createShader(t);if(this.context.shaderSource(n,e),this.context.compileShader(n),this.context.getShaderParameter(n,this.context.COMPILE_STATUS))return n;throw console.log(this.context.getShaderInfoLog(n)),this.context.deleteShader(n),"[SHADER ERROR]: Unable to load shader "+t},e.prototype._createProgram=function(t,e){var n=this.context.createProgram();if(this.context.attachShader(n,t),this.context.attachShader(n,e),this.context.linkProgram(n),this.context.getProgramParameter(n,this.context.LINK_STATUS))return n;throw console.log(this.context.getProgramInfoLog(n)),this.context.deleteProgram(n),"[SHADER ERROR]: Unable to link shaders to program"},e}(u.default);e.default=f},527:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});e.default=function(t){this.image=t}},314:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.register=function(e,n){if(!t.managers.has(e.name)){var o=new n;t.managers.set(e.name,o)}},t.get=function(e){if(t.managers.has(e))return t.managers.get(e);throw"Manager has not been registered: "+e},t.log=function(){t.managers.forEach((function(t){return console.log(t)}))},t.managers=new Map,t}();e.default=n},954:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var r=o(n(314)),i=o(n(869)),a=function(){function t(){this.id="",this.enabled=!0}return t.prototype.addComponent=function(t){r.default.get(t.constructor.name).addComponentInstance(this,t)},t.prototype.getComponent=function(t){if(t.name===i.default.name)throw"Getting script components is not currently supported.";var e=r.default.get(t.name);return e.instances[e.map[this.id]]},t.prototype.getScriptInstances=function(){return[]},t}();e.default=a},631:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});e.default=function(t,e){this.tilesets=[],this.scene=t,this.tilesets=e}},537:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});e.default=function(t,e){this.x=t,this.y=e}},625:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});e.default=function(t,e){this.x=t,this.y=e}},418:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e,n,o){this.x=t,this.y=e,this.width=n,this.height=o}return t.prototype.getScreenX=function(t){return this.x-t.viewport.x},t.prototype.clampX=function(t,e){return this.x<t?(this.x=t,!0):this.x>e?(this.x=e,!0):void 0},t.prototype.clampY=function(t,e){return this.y<=t?(this.y=t,!0):this.y>=e?(this.y=e,!0):void 0},t.prototype.offsetX=function(){return this.x+this.width},t.prototype.offsetY=function(){return this.y+this.height},t.prototype.lerp=function(t,e,n){return t+(e-t)*((n=n<0?0:n)>1?1:n)},Object.defineProperty(t,"empty",{get:function(){return new t(0,0,0,0)},enumerable:!1,configurable:!0}),t}();e.default=n},304:function(t,e,n){var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function a(t){try{u(o.next(t))}catch(t){i(t)}}function s(t){try{u(o.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((o=o.apply(t,e||[])).next())}))},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=i(n(937)),s=i(n(892)),u=i(n(527)),c=i(n(631)),l=function(){function t(){}return t.load=function(t,e){return void 0===e&&(e=null),o(this,void 0,void 0,(function(){var n,i,l,f,p=this;return r(this,(function(h){switch(h.label){case 0:return console.log("[ENGINE]: Started loading scene."),n="scenes\\"+t+".json",e&&(n=e+"\\"+n),console.log(n),[4,fetch(n)];case 1:return i=h.sent(),console.log("[ENGINE]: Scene feteched successfully;"),[4,i.json()];case 2:return l=h.sent(),console.log("[ENGINE]: Scene parsed successfully;"),a.default.getInstance().parseEntities(l),console.log("[ENGINE]: Scene entities parsed successfully."),f=[],l.tilesets.forEach((function(t,e){return o(p,void 0,void 0,(function(){var e,n;return r(this,(function(o){switch(o.label){case 0:return console.log(t),e=new Image,n="tilesets/"+t,s.default.baseUrl&&(n="file://"+s.default.baseUrl.replace(/\\/g,"/")+"/"+n),e.src=n,[4,e.decode()];case 1:return o.sent(),f.push(new u.default(e)),[2]}}))}))})),[2,new c.default(l,f)]}}))}))},t}();e.default=l},122:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.register=function(e){-1===t.systems.findIndex((function(t){return t.name===e.name}))&&t.systems.push(e)},t.get=function(e){return t.systems.find((function(t){return t.name===e}))},t.systems=[],t}();e.default=n},871:(t,e)=>{var n;Object.defineProperty(e,"__esModule",{value:!0}),e.CollisionDirection=void 0,(n=e.CollisionDirection||(e.CollisionDirection={}))[n.NONE=0]="NONE",n[n.TOP=1]="TOP",n[n.RIGHT=2]="RIGHT",n[n.BOTTOM=3]="BOTTOM",n[n.LEFT=4]="LEFT"},702:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=i(n(975)),s=i(n(314)),u=i(n(869)),c=i(n(6)),l=i(n(525)),f=n(871),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="collision",e.currentEntityCollisions=new Map,e}return r(e,t),e.prototype.dispose=function(t){this.currentEntityCollisions.has(t.id)&&this.currentEntityCollisions.delete(t.id),this.currentEntityCollisions.forEach((function(e,n){var o=e.indexOf(t.id);-1!==o&&e.splice(o,1)}))},e.prototype.update=function(){for(var t=s.default.get(a.default.name),e=0;e<t.entities.length;e++)for(var n=e+1;n<t.entities.length;n++)this.resolveCollision(t.entities[e],t.entities[n])},e.prototype.resolveCollision=function(t,e){if(t&&e){var n=t.getComponent(a.default),o=e.getComponent(a.default),r=t.getComponent(c.default),i=e.getComponent(c.default);if(r&&i){var l=r.transform,p=i.transform,h=l.x+l.width/2-(p.x+p.width/2),d=l.y+l.height/2-(p.y+p.height/2),_=l.width/2+p.width/2,y=l.height/2+p.height/2,v=f.CollisionDirection.NONE;if(Math.abs(h)<_&&Math.abs(d)<y)if(this.currentEntityCollisions.has(t.id)&&-1!==this.currentEntityCollisions.get(t.id).indexOf(e.id))console.log("TRIGGER STAY"),t.getScriptInstances().forEach((function(t){t.instance&&t.instance.onTriggerEnter&&t.instance.onTriggerStay(e)})),e.getScriptInstances().forEach((function(e){e.instance&&e.instance.onTriggerEnter&&e.instance.onTriggerStay(t)}));else if(this.currentEntityCollisions.has(t.id)?this.currentEntityCollisions.get(t.id).push(e.id):this.currentEntityCollisions.set(t.id,[e.id]),n.isTrigger||o.isTrigger)console.log("TRIGGER ENTER"),console.log(t),console.log(e),t.getScriptInstances().forEach((function(t){t.instance&&t.instance.onTriggerEnter&&t.instance.onTriggerEnter(e)})),e.getScriptInstances().forEach((function(e){e.instance&&e.instance.onTriggerEnter&&e.instance.onTriggerEnter(t)}));else{var g=_-Math.abs(h),m=y-Math.abs(d);g>=m?d>0?(v=f.CollisionDirection.TOP,l.y+=m):(v=f.CollisionDirection.BOTTOM,l.y-=m):h>0?(v=f.CollisionDirection.LEFT,l.x+=g):(v=f.CollisionDirection.RIGHT,l.x-=g)}else this.currentEntityCollisions.has(t.id)&&-1!==this.currentEntityCollisions.get(t.id).indexOf(e.id)&&(this.currentEntityCollisions.delete(t.id),s.default.get(u.default.name).instances,t.getScriptInstances().forEach((function(t){t.instance&&t.instance.onTriggerEnter&&t.instance.onTriggerLeave(e)})),e.getScriptInstances().forEach((function(e){e.instance&&e.instance.onTriggerEnter&&e.instance.onTriggerLeave(t)})));return v}console.log("[ENTITY NO LONGER EXISTS ABORTING COLLISION CHECK]")}},e}(l.default);e.default=p},355:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=i(n(314)),s=i(n(869)),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="script",e}return r(e,t),e.prototype.update=function(){var t=a.default.get(s.default.name);t.entities.forEach((function(e){var n=t.getInstance(e);n.instance||(n.instance=new n.scritableEntity,n.instance.onCreate()),n.instance.update()}))},e.prototype.dispose=function(t){},e}(i(n(525)).default);e.default=u},525:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});e.default=function(){}},193:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.calculateDeltaTime=function(e){if(!t.lastTimestamp)return t.lastTimestamp=e,void(t.fps=0);t.deltaTime=(e-t.lastTimestamp)/1e3,t.lastTimestamp=e,t.fps=1/t.deltaTime},t.lastTimestamp=performance.now(),t}();e.default=n}},e={};!function n(o){if(e[o])return e[o].exports;var r=e[o]={exports:{}};return t[o].call(r.exports,r,r.exports,n),r.exports}(17)})();